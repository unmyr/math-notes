ifndef::leveloffset[]
:toc: left
:toclevels: 3
:icons: font
:stem: latexmath
endif::[]

ifndef::imagesdir[]
:imagesdir: images
endif::[]

include::header.adoc[]

include::../../attrs.adoc[]

== 数学セミナー 2025年4月号

=== エレガントな回答もとむ: 1
次の連立方程式を解いてください。

[stem,latexmath]
++++
\begin{cases}
\frac{2x}{1 - x^2} = y \\
\frac{2y}{1 - y^2} = z \\
\frac{2z}{1 - z^2} = w \\
\frac{2w}{1 - w^2} = x \\
\end{cases}
++++

=== Notes: 0

* 割り算の式より可換体であることから、複素数まで考慮すればよい
* 4回の操作を繰り返してもとに戻ることから、群論の考え方を適用できる
** 部分群で簡単な解をいくつか見つけられるが、すべて見つけるには泥臭くエレガントとは言えない。

元の値に戻ってくるからか変換自体は何らかの不変量をもち、いくつか確認できた解は |x/y| などの比の絶対値は 1 になる。
おそらく、回転に近い操作があって、うまく変数変換ができればうまく解が見つかる気がするが、やり方が分からない。

エレガントでないにしても、解のいくつかが分かることで、その解で割り切れる式が分かるので途中までは力技で因数分解できる。

=== Notes 1: {f}{nbsp} = {e} の解

{f}{nbsp}^4^ = {e} ということであるから、{f}={f}を満たす場合も解に含まれる。 +
以下を計算をすると、 ({x},{nbsp}{y},{nbsp}{z},{nbsp}{w})={ (0, 0, 0, 0), (±{i}, ±{i}, ±{i}, ±{i}) }も解であると分かる。

[stem,latexmath]
++++
\begin{align*}
\frac{2x}{1-x^2} &= x \\
2x &= x (1 - x^2) \\
0 &= x (-1 - x^2) \\
0 &= x (1 + x^2) \\
\end{align*}
++++

[stem,latexmath]
++++
\begin{align*}
\frac{2x}{1 - x^2} &= y \\
2x &= y \left\{2 - (1 + x^2)\right\} \\
0 &= y \left\{2 - (1 + x^2)\right\} -2x \\
0 &= 2y - (1 + x^2)y -2x \\
0 &= - (1 + x^2)y -2(x - y) \\
0 &= (1 + x^2)y + 2(x - y) \\
\end{align*}
++++

=== Notes 2: {f}{nbsp}^2^ = {e} の解

{f}{nbsp}^4^ = {e} ということであるから、{f}={f}{nbsp}^2^ を満たす場合も解に含まれる。 +
以下を計算をすると、 ({x},{nbsp}{y},{nbsp}{z},{nbsp}{w})=(±√3, ∓√3, ±√3, ∓√3) も解であると分かる。

[stem,latexmath]
++++
\begin{align*}
\frac{2y}{1 - y^2} &= z \\ 
2y &= z (1 - y^2) \\
2y &= z (2 - (1 + y^2)) \\
\frac{y}{z} &= 1 - \frac{1 + y^2}{2} \\
1 - \frac{y}{z} &= \frac{1 + y^2}{2} \\
\end{align*}
++++

ここで、 1 + y^2^ を計算しておく。

[stem,latexmath]
++++
\begin{align*}
1 + y^2 &= 1 + (\frac{2x}{1 - x^2})^2 \\
&= \frac{(1 - x^2)^2  + 4 x^2}{(1 - x^2)^2} \\
&= \frac{\left\{2 - (1 + x^2)\right\}^2  + 4\left\{(-1) + (1 + x^2) \right\}}{(1 - x^2)^2} \\
&= \frac{(1 + x^2)^2  -4(1 + x^2) + 4 + 4(1 + x^2) - 4}{(1 - x^2)^2} \\
&= \frac{(1 + x^2)^2}{(1 - x^2)^2} \\
&= \frac{(1 + x^2)\left\{4 + (-3 + x^2)\right\}}{(1 - x^2)^2} \\
&= \frac{(1 + x^2)(x^2 - 3) + 4(1 + x^2)}{(1 - x^2)^2} \\
\end{align*}
++++

上記を代入し、{y}を消去する。

[stem,latexmath]
++++
\begin{align*}
\frac{y}{z} &= 1 - \frac{1 + y^2}{2} \\
\frac{2x}{z(1 - x^2)} &= 1 - \frac{1}{2} \frac{(1 + x^2)^2}{2(1 - x^2)^2} \\
\frac{2}{1 - x^2}\frac{x}{z} &= \frac{2(1 - x^2)^2 - (1 + x^2)^2}{2(1 - x^2)^2} \\
\frac{x}{z} &= \frac{2(1 - x^2)^2 - (1 + x^2)^2}{4(1 - x^2)} \\
1 - \frac{x}{z} &= 1 - \frac{2(1 - x^2)^2 - (1 + x^2)^2}{4(1 - x^2)} \\
1 - \frac{x}{z} &= \frac{4(1 - x^2) - 2(1 - x^2)^2 + (1 + x^2)^2}{4(1 - x^2)} \\
1 - \frac{x}{z} &= \frac{2(1 - x^2)(1 + x^2) + (1 + x^2)^2}{4(1 - x^2)} \\
1 - \frac{x}{z} &= \frac{(1 + x^2)\left\{2(1 - x^2) + (1 + x^2)\right\} + (1 + x^2)^2}{4(1 - x^2)} \\
1 - \frac{x}{z} &= \frac{(1 + x^2)(3 - x^2)}{4(1 - x^2)} \\
1 - \frac{x}{z} &= - \frac{(1 + x^2)(x^2 - 3)}{4(1 - x^2)} \\
\end{align*}
++++

ここで、{z}={x}とおくと、次のようになる。

[stem,latexmath]
++++
\begin{align*}
1 - \left.\frac{x}{z}\right|_{z=x} &= - \frac{(1 + x^2)(x^2 - 3)}{4(1 - x^2)} \\
0 &= - \frac{(1 + x^2)(x^2 - 3)}{4(1 - x^2)} \\
\end{align*}
++++

=== Notes 3: {f}{nbsp}^4^ = {e}の解

かきかけ。
以下の式より、対称性を考慮して、同様の式を導出する。

[stem,latexmath]
++++
\begin{cases}
\frac{2z}{1 - z^2} = w \\
\frac{2w}{1 - w^2} = x \\
\end{cases}
++++

[stem,latexmath]
++++
\begin{align*}
\frac{2w}{1 - w^2} &= x \\ 
2w &= x (1 - w^2) \\
2w &= x (2 - (1 + w^2)) \\
\frac{w}{x} &= 1 - \frac{1 + w^2}{2} \\
\end{align*}
++++

同様に 1 + w^2^ を計算しておく。

[stem,latexmath]
++++
\begin{align*}
1 + w^2 &= 1 + (\frac{2z}{1 - z^2})^2 \\
&= \frac{(1 - z^2)^2  + 4 z^2}{(1 - z^2)^2} \\
&= \frac{\left\{2 - (1 + z^2)\right\}^2  + 4\left\{(-1) + (1 + z^2) \right\}}{(1 - z^2)^2} \\
&= \frac{(1 + z^2)^2  -4(1 + z^2) + 4 + 4(1 + z^2) - 4}{(1 - z^2)^2} \\
&= \frac{(1 + z^2)^2}{(1 - z^2)^2} \\
&= \frac{(1 + z^2)\left\{4 + (-3 + z^2)\right\}}{(1 - z^2)^2} \\
&= \frac{(1 + z^2)(z^2 - 3) + 4(1 + z^2)}{(1 - z^2)^2} \\
\end{align*}
++++

{w}を消去して、{z}と{x}の式を作る。

[stem,latexmath]
++++
\begin{align*}
\frac{w}{x} &= 1 - \frac{1 + w^2}{2} \\
\frac{2z}{x(1 - z^2)} &= 1 - \frac{(1 + z^2)^2}{2(1 - z^2)^2} \\
\frac{2}{1 - z^2} \cdot \frac{z}{x} &= 1 - \frac{(1 + z^2)^2}{2(1 - z^2)^2} \\
\frac{z}{x} &= \frac{1 - z^2}{2} - \frac{(1 + z^2)^2}{4(1 - z^2)} \\
1 - \frac{z}{x} &= 1 - \frac{1 - z^2}{2} + \frac{(1 + z^2)^2}{4(1 - z^2)} \\
1 - \frac{z}{x} &= \frac{2 - 1 + z^2}{2} + \frac{(1 + z^2)^2}{4(1 - z^2)} \\
1 - \frac{z}{x} &= \frac{1 + z^2}{2} + \frac{(1 + z^2)^2}{4(1 - z^2)} \\
1 - \frac{z}{x} &= \frac{2(1 + z^2)(1 - z^2) + (1 + z^2)^2}{4(1 - z^2)} \\
1 - \frac{z}{x} &= \frac{(1 + z^2)\left\{2(1 - z^2) + (1 + z^2)\right\}}{4(1 - z^2)} \\
1 - \frac{z}{x} &= \frac{(1 + z^2)(3  -  z^2)}{4(1 - z^2)} \\
1 - \frac{z}{x} &= -\frac{(1 + z^2)(z^2 - 3)}{4(1 - z^2)} \\
\end{align*}
++++

zを消去するため、zとx式を作る。

[stem,latexmath]
++++
\begin{align*}
z &= \frac{2y}{1 - y^2} \\
&= \frac{2\cdot\frac{2x}{1 - x^2}}{1 - \left(\frac{2x}{1 - x^2}\right)^2} \\
&= 4\frac{x(1 - x^2)}{(1 - x^2)^2 - 4 x^2} \\
&= 4\frac{x(1 - x^2)}{ x^4 - 6 x^2 + 1} \\
\frac{z}{x} &= 4\frac{1 - x^2}{(1 - x^2)^2 - 4 x^2} \\
\frac{z}{x} &= 4\frac{1 - x^2}{x^4 - 6x^2 + 1} \\
1 - \frac{z}{x} &= 1 - 4\frac{1 - x^2}{x^4 - 6x^2 + 1} \\
1 - \frac{z}{x} &= \frac{(x^4 - 6x^2 + 1) - 4 + 4 x^2}{x^4 - 6x^2 + 1} \\
1 - \frac{z}{x} &= \frac{x^4 - 2x^2 - 3}{x^4 - 6x^2 + 1} \\
1 - \frac{z}{x} &= \frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1} \\
\end{align*}
++++

(1-x^2^)^2^ - 4x^2^を計算しておく。

[stem,latexmath]
++++
\begin{align*}
(1 - x^2)^2 - 4x^2
&= x^4 - 2x^2 + 1 - 4x^2 \\
&= x^4 - 3x^2 - 3x^2 + 1 \\
&= x^2(x^2 - 3) - 3x^2 + 1 \\
&= \left\{(-1) + (1 + x^2)\right\}(x^2 - 3) - 3x^2 + 1 \\
&= (1 + x^2)(x^2 - 3) - (x^2 - 3) - 3x^2 + 1 \\
&= (1 + x^2)(x^2 - 3) - 4x^2 + 4 \\
&= (1 + x^2)(x^2 - 3) - 4(1 + x^2) + 8 \\
\end{align*}
++++

zを消去するため、 1+{z}^2^ とxの式を作る。

[stem,latexmath]
++++
\begin{align*}
1 + z^2 &= 1 + \left\{4\frac{x(1 - x^2)}{x^4 - 6x^2 + 1}\right\}^2 \\
&=\frac{(x^4 - 6x^2 + 1)^2 + 4^2 x^2 (1 - x^2)^2}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{x^8 + 4x^6 + 6x^4 + 4x^2 + 1}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{x^8 + x^6  + 3x^6 + 3x^4 + 3x^4 + 3x^2 + x^2 + 1}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{x^6(1 + x^2)  + 3x^4(1 + x^2) + 3x^2(1 + x^2) + (1 + x^2)}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{(1 + x^2)(x^6 + 3x^4 + 3x^2 + 1)}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{(1 + x^2)\left\{x^4(1 + x^2) + 2x^2(1 + x^2) + (1 + x^2)\right\}}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{(1 + x^2)^2(x^4 + 2x^2 + 1)}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{(1 + x^2)^4}{(x^4 - 6x^2 + 1)^2} \\
\end{align*}
++++

zを消去するため、 {z}^2^ - 3 とxの式を作る。

[stem,latexmath]
++++
\begin{align*}
z^2 - 3 &= \left\{4\frac{x(1 - x^2)}{x^4 - 6x^2 + 1}\right\}^2 - 3 \\
&= \frac{4^2 x^2(1 - x^2)^2 - 3(x^4 - 6x^2 + 1)^2}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{-3 x^8 + 52 x^6 -146 x^4 + 52 x^2 - 3}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{(-3 x^8 + 9 x^6) + (43x^6 -129 x^4) + (- 17x^4 + 51 x^2)  + (x^2 - 3)}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{-3 x^6(x^2 - 3) + 43 x^4(x^2 - 3) - 17x^2(x^2 - 3)  + (x^2 - 3)}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{(x^2 - 3)(-3 x^6 + 43 x^4 - 17x^2  + 1)}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{(x^2 - 3)\left\{(-3 x^6 + x^4) + (42 x^4 - 14x^2) + (- 3x^2 + 1)\right\}}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{(x^2 - 3)\left\{- x^4(3x^2 - 1) + 14 x^2(3x^2 - 1) - (3x^2 - 1)\right\}}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{(x^2 - 3)(3x^2 - 1)(- x^4 + 14 x^2 - 1)}{(x^4 - 6x^2 + 1)^2} \\
&= -\frac{(x^2 - 3)(3x^2 - 1)(x^4 - 14 x^2 + 1)}{(x^4 - 6x^2 + 1)^2} \\
&= -\frac{(x^2 - 3)(3x^2 - 1)\left\{(x^4 + 2x^2 + 1) - 16 x^2\right\}}{(x^4 - 6x^2 + 1)^2} \\
&= -\frac{(x^2 - 3)(3x^2 - 1)\left\{(x^2 + 1)^2 - 16 x^2\right\}}{(x^4 - 6x^2 + 1)^2} \\
&= -\frac{(x^2 - 3)(3x^2 - 1)(x^2 - 4x + 1)(x^2 + 4x + 1)}{(x^4 - 6x^2 + 1)^2} \\
\end{align*}
++++

zを消去するため、 1 - {z}^2^ とxの式を作る。

[stem,latexmath]
++++
\begin{align*}
1 - z^2 &= 1 - \left\{4\frac{x(1 - x^2)}{x^4 - 6x^2 + 1}\right\}^2 \\
&= \frac{(x^4 - 6x^2 + 1)^2 - 4^2 x^2(1 - x^2)^2}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{(x^4 - 6x^2 + 1)^2 - 4^2 x^2(1 - x^2)^2}{(x^4 - 6x^2 + 1)^2} \\
&= \frac{\left\{(x^4 - 6x^2 + 1) - 4 x (1 - x^2)\right\}\left\{(x^4 - 6x^2 + 1) + 4 x (1 - x^2)\right\}}{(x^4 - 6x^2 + 1)^2} \\
&=\frac{x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1}{(x^4 - 6x^2 + 1)^2} \\
\end{align*}
++++

zを消去する。

* {x}^4^ - 10{x}^2^ + 5 = 0 の解は、 latexmath:[x_1 = - \sqrt{5 + 2\sqrt{5}}], latexmath:[x_2 = - \sqrt{5 - 2\sqrt{5}}], latexmath:[x_3 = \sqrt{5 - 2\sqrt{5}}], latexmath:[x_4 = \sqrt{5 + 2\sqrt{5}}] である。
* {x}^8^ - 92{x}^6^ + 134 {x}^4^ - 28{x}^2^ + 1 = 0 の解は、解き方は分からないが近似値は ±1.111, ±0.445, ±0.213 辺りがグラフから読み取ることができる。

// 4((x^4 - 6x^2 +1)^2 - 4^2 x^2 (1-x^2)^2 ) - (1+x^2)^3(3x^2 - 1)(x^2 - 4x +1)(x^2 +4x +1)(x^4 -6x^2 +1)
// \(-3x^{16}+52x^{14}-104x^{12}-508x^{10}-354x^{8}-20x^{6}+360x^{4}-132x^{2}+5\)
// -3x^16 + 52 x^14 -104 x^12 - 508 x^10 - 354 x^8 - 20 x^6 + 360 x^4 - 132 x^2 + 5

[stem,latexmath]
++++
\begin{align*}
1 - \frac{z}{x} &= -\frac{(1 + z^2)(z^2 - 3)}{4(1 - z^2)} \\

\frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1}
&= \frac{1}{4} \frac{(x^4 - 6x^2 + 1)^2}{(x^4 - 6x^2 + 1)^2 - 4^2 x^2(1 - x^2)^2} \cdot \frac{(1 + x^2)^4}{(x^4 - 6x^2 + 1)^2} \cdot \frac{(x^2 - 3)(3x^2 - 1)(x^2 - 4x + 1)(x^2 + 4x + 1)}{(x^4 - 6x^2 + 1)^2} \\

&= \frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1} \cdot \frac{(1 + x^2)^3(3x^2 - 1)(x^2 - 4x + 1)(x^2 + 4x + 1)}{4 (x^4 - 6x^2 + 1)(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1)} \\

0 &= \frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1} \cdot \left\lbrack
    1 - \frac{(1 + x^2)^3(3x^2 - 1)(x^2 - 4x + 1)(x^2 + 4x + 1)}{4 (x^4 - 6x^2 + 1)(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1)}
\right\rbrack \\

0 &= \frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1} \cdot
     \frac{4 (x^4 - 6x^2 + 1)(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1) - (1 + x^2)^3(3x^2 - 1)(x^2 - 4x + 1)(x^2 + 4x + 1)}{4 (x^4 - 6x^2 + 1)(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1)} \\

0 &= \frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1} \cdot
     \frac{x^{12} - 102x^{10} + 1059 x^8 - 1828 x^6 + 951 x^4 - 150 x^2 + 5}{4 (x^4 - 6x^2 + 1)(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1)} \\

0 &= \frac{(1 + x^2)(x^2 - 3)}{x^4 - 6x^2 + 1} \cdot
     \frac{(x^4 - 10 x^2 + 5)(x^8 - 92 x^6 + 134 x^4 - 28 x^2 + 1)}{4 (x^4 - 6x^2 + 1)(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1)} \\

0 &= (1 + x^2)(x^2 - 3)(x^2 - 5 - 2\sqrt{5})(x^2 - 5 + 2\sqrt{5}) \cdot
     \frac{x^8 - 92 x^6 + 134 x^4 - 28 x^2 + 1}{4 (x^4 - 6x^2 + 1)^2(x^8 - 28 x^6 + 70 x^4 - 28 x^2 + 1)} \\

\end{align*}
++++

image::seminar_2025_04_notes3_graph.png[]
